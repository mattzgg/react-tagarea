{"version":3,"file":"main.js","sources":["webpack://@mattzgg/react-tagarea/main.js"],"sourcesContent":["module.exports=(()=>{\"use strict\";var t={617:(t,e,n)=>{n.r(e),n.d(e,{default:()=>G});const r=require(\"react\");var i=n.n(r);const a=require(\"prop-types\");var o=n.n(a);const u=require(\"lodash\");var c=n.n(u);function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.width=e||0,this.height=n||0}var e,n;return e=t,(n=[{key:\"getWidth\",value:function(){return this.width}},{key:\"setWidth\",value:function(t){this.width=t}},{key:\"getHeight\",value:function(){return this.height}},{key:\"setHeight\",value:function(t){this.height=t}},{key:\"add\",value:function(e){return new t(this.getWidth()+e.getWidth(),this.getHeight()+e.getHeight())}},{key:\"equals\",value:function(e){return e instanceof t&&this.width===e.width&&this.height===e.height}}])&&l(e.prototype,n),t}();function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.x=e||0,this.y=n||0}var e,n,r;return e=t,r=[{key:\"copy\",value:function(e){return new t(e.getX(),e.getY())}}],(n=[{key:\"getX\",value:function(){return this.x}},{key:\"setX\",value:function(t){this.x=t}},{key:\"getY\",value:function(){return this.y}},{key:\"setY\",value:function(t){this.y=t}},{key:\"offset\",value:function(e,n){var r=e,i=n;if(e instanceof t){var a=e;r=a.getX(),i=a.getY()}else if(e instanceof s){var o=e;r=o.getWidth(),i=o.getHeight()}return r=r||0,i=i||0,new t(this.getX()+r,this.getY()+i)}},{key:\"offsetX\",value:function(e){var n=e;return e instanceof t?n=e.getX():e instanceof s&&(n=e.getWidth()),this.offset(n,0)}},{key:\"offsetY\",value:function(e){var n=e;return e instanceof t?n=e.getY():e instanceof s&&(n=e.getHeight()),this.offset(0,n)}},{key:\"getDifference\",value:function(t){return new s(this.getX()-t.getX(),this.getY()-t.getY())}},{key:\"isTopAligned\",value:function(t){return this.getY()===t.getY()}},{key:\"isLeftAligned\",value:function(t){return this.getX()===t.getX()}}])&&f(e.prototype,n),r&&f(e,r),t}();function g(t){return t.tagName.toLowerCase()}function d(t){var e=g(t);return/^(?:body|html)$/i.test(e)}function p(t){var e;if(t instanceof Document)e=t;else{if(!(t instanceof Window))throw new Error(\"Invalid object. It must be either the global window or document.\");e=t.document}return e.compatMode&&\"CSS1Compat\"!==e.compatMode?e.body:e.html}function y(t){return t.ownerDocument}function v(t){return y(t).window}function m(t){var e=p(v(t));return{x:e.clientWidth,y:e.clientHeight}}function b(t){if(d(t))return m(t);if(!window.getComputedStyle)return{x:t.offsetWidth,y:t.offsetHeight};if(\"svg\"===g(t))return function(t){var e=window.getComputedStyle(t),n={x:0,y:0};return[\"height\",\"paddingTop\",\"paddingBottom\",\"borderTopWidth\",\"borderBottomWidth\"].each((function(t){n.y+=parseFloat(e[t])})),[\"width\",\"paddingLeft\",\"paddingRight\",\"borderLeftWidth\",\"borderRightWidth\"].each((function(t){n.x+=parseFloat(e[t])})),n}(t);try{var e=t.getBoundingClientRect();return{x:e.width,y:e.height}}catch(t){return{x:0,y:0}}}function w(t){return d(t)?function(t){var e=p(v(t)),n=m(t),r=y(t).body;return{x:Math.max(e.scrollWidth,r.scrollWidth,n.x),y:Math.max(e.scrollHeight,r.scrollHeight,n.y)}}(t):{x:t.scrollWidth,y:t.scrollHeight}}function k(t){return(k=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function T(t,e){return(T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t,e){return!e||\"object\"!==k(e)&&\"function\"!=typeof e?function(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}(t):e}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var S,P,W,j=function(t){!function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(u,t);var e,n,r,a,o=(r=u,a=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=R(r);if(a){var n=R(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return O(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,u),(e=o.call(this,t)).tagRef=i().createRef(),e.tagActionsRef=i().createRef(),e}return e=u,(n=[{key:\"getDimension\",value:function(){var t=b(this.tagRef.current);return new s(t.x,t.y)}},{key:\"getTagActionsDimension\",value:function(){var t=b(this.tagActionsRef.current);return new s(t.x,t.y)}},{key:\"render\",value:function(){var t=this.props,e=t.location,n=t.text,r=t.textWidth,a=t.children,o={left:e.getX(),top:e.getY()};return i().createElement(\"div\",{className:\"rc-tagarea-tag\",style:o,ref:this.tagRef},i().createElement(\"table\",{cellSpacing:0,cellPadding:0,className:\"rc-tagarea-tag-content\"},i().createElement(\"tr\",null,i().createElement(\"td\",{style:{verticalAlign:\"middle\"}},i().createElement(\"div\",{className:\"rc-tagarea-tag-text\",style:{width:r},title:\"auto\"===r?\"\":n},n)),i().createElement(\"td\",null,i().createElement(\"div\",{ref:this.tagActionsRef},a)))))}}])&&x(e.prototype,n),u}(i().Component);S=j,P=\"propTypes\",W={location:o().instanceOf(h).isRequired,text:o().string.isRequired,textWidth:o().number.isRequired,children:o().node.isRequired},P in S?Object.defineProperty(S,P,{value:W,enumerable:!0,configurable:!0,writable:!0}):S[P]=W;var I=function(t){var e=t.title,n=t.className,r=t.style,a=t.action,o=t.children,u=\"rc-tagarea-tag-action \".concat(n);return i().createElement(\"div\",{title:e,className:u,style:r,onClick:a},o)};I.propTypes={title:o().string.isRequired,className:o().string,style:o().string,action:o().func,children:o().node},I.defaultProps={className:\"\",style:\"\",action:function(){},children:null};const L=I;function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var E=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.topLeft=e,this.bottomRight=n}var e,n;return e=t,(n=[{key:\"getWidth\",value:function(){return this.bottomRight.getDifference(this.topLeft).getWidth()}},{key:\"getHeight\",value:function(){return this.bottomRight.getDifference(this.topLeft).getHeight()}}])&&C(e.prototype,n),t}();function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var D=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t)}var e,n;return e=t,n=[{key:\"substituteHTMLEntities\",value:function(t){return String(t).replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\")}},{key:\"calculateWidthOfAString\",value:function(e){var n=document.createElement(\"span\");n.classList.add(\"rc-tagarea-width-ruler\"),n.innerHTML=t.substituteHTMLEntities(e),document.body.appendChild(n);var r=Math.ceil(b(n).x);return n.remove(),r}},{key:\"trampoline\",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=t.apply(t,n);c().isFunction(i);)i=i();return i}},{key:\"withTimeProfiling\",value:function(t,e,n){return function(){for(var r=c().now(),i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];var u=t.apply(e,a),l=c().now(),s=(l-r)/1e3;return console.log(\"Executing the method[\".concat(n,\"] costs \").concat(s,\" second(s).\")),u}}},{key:\"isNil\",value:function(t){return null==t}}],null&&H(e.prototype,null),n&&H(e,n),t}();function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function B(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){F(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function q(t){return(q=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function X(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Y(t,e){return(Y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function N(t,e){return!e||\"object\"!==q(e)&&\"function\"!=typeof e?M(t):e}function M(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}function z(t){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function F(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var K=function(t,e){return new Promise((function(n){t.setState(e,n)}))},G=function(t){!function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Y(t,e)}(u,t);var e,n,r,a,o=(r=u,a=function(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=z(r);if(a){var n=z(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return N(this,t)});function u(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,u);var n=(e=o.call(this,t)).props.tags,r=[];return e.initialBound=e.calculateInitialBound(),e.initialLocation=e.calculateInitialLocation(),e.inputChanging=!1,c().each(n,(function(t){var e,n;\"object\"===q(t)?(e=t.text,n=t.value):(e=t,n=t),r.push({text:e,value:n,dimension:new s(0,0),textWidth:\"auto\"})})),e.state={pendingText:\"\",tags:r,boundWidth:e.initialBound.getWidth(),inputScrollHeight:e.initialBound.getHeight()},e.tagComponents=[],e.cache={},e.handleResize=D.withTimeProfiling(e.handleResize,M(e),\"handleResize\"),e.render=D.withTimeProfiling(e.render,M(e),\"render\"),e.handleScroll=e.handleScroll.bind(M(e)),e.handleInputChange=e.handleInputChange.bind(M(e)),e.handleInputKeyPressed=e.handleInputKeyPressed.bind(M(e)),e.handleInputKeyDown=e.handleInputKeyDown.bind(M(e)),e.handleInputFocused=e.handleInputFocused.bind(M(e)),e.mainRef=i().createRef(),e.inputRef=i().createRef(),e}return e=u,(n=[{key:\"componentWillUpdate\",value:function(){this.inputChanging||(this.cache={})}},{key:\"handleInputChange\",value:function(t){var e=this,n=t.target.value;this.inputChanging=!0,K(this,{pendingText:n}).then((function(){return e.shrinkInputHeight()})).then((function(){return e.handleResize()})).then((function(){e.inputChanging=!1}))}},{key:\"handleInputKeyPressed\",value:function(t){var e=this;if(\"Enter\"===t.key){var n=this.state.pendingText,r=n;this.clearPendingText().then((function(){return e.createTag(n,r)})),t.preventDefault()}}},{key:\"handleInputKeyDown\",value:function(t){var e=t.key,n=this.state.pendingText,r=this.getLastTag();\"Backspace\"===e&&\"\"===n&&r&&this.deleteTag(r)}},{key:\"handleScroll\",value:function(){}},{key:\"handleInputFocused\",value:function(){}},{key:\"handleResize\",value:function(){var t,e,n=this,r=this.state.boundWidth,i=this.props,a=i.tagSpacing,o=i.tagBorderWidth,u=i.tagGutterSize,l=this.calculateBound().getWidth(),s=l-a,f=!1;return r!==l||f?K(this,{tags:(t=[],e=n.state.tags,c().each(e,(function(e,r){var i=n.tagComponents[r],c=i.getDimension(),l=i.getTagActionsDimension(),h=\"auto\";c.getWidth()>=s&&(c.setWidth(s),h=s-a-2*o-2*u-l.getWidth());var g=_(_({},e),{},{dimension:c,textWidth:h});f||g.dimension.equals(e.dimension)&&g.textWidth===e.textWidth||(f=!0),t.push(g)})),t),boundWidth:l}).then((function(){return n.handleResize()})):Promise.resolve()}},{key:\"getFirstTag\",value:function(){var t=this.state.tags;return t.length>0?t[0]:null}},{key:\"getLastTag\",value:function(){var t=this.state.tags,e=t.length;return e>0?t[e-1]:null}},{key:\"calculateInputHeight\",value:function(){var t=this.getLastTag();if(!t)return this.initialBound.getHeight();var e=this.calculateTagLocation(t),n=this.state.pendingText,r=D.calculateWidthOfAString(n),i=this.calculateTargetLocation(t,e,r);return i.isTopAligned(e)&&(i=e),i.offsetY(t.dimension).getDifference(this.initialBound.topLeft).getHeight()}},{key:\"calculateInputPaddings\",value:function(){var t,e=this.getLastTag();if(e){var n=this.calculateTagLocation(e),r=this.state.pendingText,i=D.calculateWidthOfAString(r);t=this.calculateTargetLocation(e,n,i)}else t=this.initialLocation;return{top:t.y,left:t.x}}},{key:\"calculateTagLocation\",value:function(t){var e=this,n=this.state.tags,r=t,i=c().indexOf(n,r),a=this.cache[i];if(!a){var o=this.getFirstTag(),u=h.copy(this.initialLocation);a=D.trampoline((function t(a,o){return o===r?(e.cache[i]=a,a):function(){var r=c().indexOf(n,o)+1,i=n[r],u=e.cache[r];return u||(u=e.calculateTargetLocation(o,a,i.dimension.getWidth()),e.cache[r]=u),t(u,i)}}),u,o)}return a}},{key:\"notifyContainerReady\",value:function(){this.handleResize()}},{key:\"calculateInitialBound\",value:function(){var t=this.props,e=t.width,n=t.height,r=t.borderWidth,i=e-2*r,a=n-2*r,o=new h(0,0),u=new h(i,a);return new E(o,u)}},{key:\"calculateInitialLocation\",value:function(){var t=this.props.tagSpacing;return this.initialBound.topLeft.offset(t,t)}},{key:\"calculateBound\",value:function(){var t=this.mainRef.current,e=this.inputRef.current,n=this.initialBound.topLeft.x,r=this.initialBound.topLeft.y,i=b(e).x,a=w(t).y,o=new h(n,r),u=new h(i,a);return new E(o,u)}},{key:\"calculateTargetLocation\",value:function(t,e,n){var r=e.offsetX(t.dimension).getDifference(this.initialBound.topLeft).getWidth();return n>=this.state.boundWidth-r?new h(this.initialLocation.getX(),e.offsetY(t.dimension).getY()):e.offsetX(t.dimension)}},{key:\"clearPendingText\",value:function(){return K(this,{pendingText:\"\"})}},{key:\"createTag\",value:function(t){for(var e=this,n=this.state.pendingText,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];var o=i[0],u=i[1];return D.isNil(o)&&(o=t),\"boolean\"==typeof o&&D.isNil(u)&&(u=o,o=t),\"\"!==n?this.clearPendingText().then((function(){var r=u?e.createTag(n,n):null;return Promise.resolve(r).then((function(){return e.createTagInternal(t,o)}))})):this.createTagInternal(t,o)}},{key:\"createTagInternal\",value:function(t,e){var n,r=this,i={text:t,value:e,dimension:new s(0,0),textWidth:\"auto\"},a=this.state.tags,o=[].concat(function(t){if(Array.isArray(t))return A(t)}(n=a)||function(t){if(\"undefined\"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(n)||function(t,e){if(t){if(\"string\"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return\"Object\"===n&&t.constructor&&(n=t.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(t):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}(n)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}(),[i]);return K(this,{tags:o}).then((function(){return r.handleResize()}))}},{key:\"deleteTag\",value:function(t){var e=this,n=this.state.tags,r=c().filter(n,(function(e){return e!==t}));return K(this,{tags:r}).then((function(){return\"\"!==e.state.pendingText?e.shrinkInputHeight():Promise.resolve()})).then((function(){return e.handleResize()}))}},{key:\"shrinkInputHeight\",value:function(){var t=this;return K(this,{inputScrollHeight:0}).then((function(){var e=w(t.inputRef.current).y;return K(t,{inputScrollHeight:e})}))}},{key:\"render\",value:function(){var t=this,e=this.props,n=e.width,r=e.height,a=e.name,o={width:n,height:r},u=this.calculateInputPaddings(),l=Math.max(this.calculateInputHeight(),this.initialBound.getHeight()),s={height:l,paddingLeft:u.left,paddingTop:u.top};this.tagComponents=[];var f=this.state,h=f.pendingText,g=f.inputScrollHeight,d=f.tags;return\"\"!==h&&g>l&&(s.height=g),i().createElement(\"div\",{ref:this.mainRef,className:\"rc-tagarea\",style:o,onScroll:this.handleScroll},i().createElement(\"textarea\",{name:a,value:h,className:\"rc-tagarea-input\",style:s,ref:this.inputRef,onChange:this.handleInputChange,onKeyPress:this.handleInputKeyPressed,onKeyDown:this.handleInputKeyDown,onFocus:this.handleInputFocused}),c().map(d,(function(e,n){var r=t.calculateTagLocation(e);return i().createElement(j,{key:n,text:e.text,value:e.value,location:r,textWidth:e.textWidth,tagarea:t,ref:function(e){e&&t.tagComponents.push(e)}},i().createElement(L,{name:\"delete\",title:\"Delete\",className:\"rc-tagarea-tag-action-delete\",action:function(){t.deleteTag(e)}},\"×\"))})))}}])&&X(e.prototype,n),u}(i().Component);F(G,\"propTypes\",{name:o().string.isRequired,tags:o().arrayOf(o().oneOfType([o().string,o().shape({text:o().string,value:o().string})])).isRequired,width:o().number.isRequired,height:o().number.isRequired,borderWidth:o().number,tagSpacing:o().number,tagBorderWidth:o().number,tagGutterSize:5}),F(G,\"defaultProps\",{borderWidth:1,tagSpacing:10,tagBorderWidth:1,tagGutterSize:5})}},e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}return n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n(617)})();"],"mappings":"AAAA","sourceRoot":""}